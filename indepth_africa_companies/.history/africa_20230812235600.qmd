---
subtitle: "***Analyzing Top Companies Africa with Python and Pandas***"
title: "**A Deeper Analysis of Africa's Corporate Landscape Using Libreoffice and Python**"
author:
  - name: John Karuitha
    orcid: 0000-0002-8204-7034
    email: jkaruitha@karu.ac.ke
    affiliations:
      - name: Karatina University, School of Business
        address: P.O. Box 1957-00100
        city: Karatina
        state: Kenya
        postal-code: 10101
      - name: Graduate School of Business Administration, University of the Witwatersrand
        address: 2nd St Davids Pl & St Andrew Rd, Parktown
        city: Johannesburg
        state: South Africa
        postal-code: 2193
title-block-banner: "Untitled.jpeg"
title-block-banner-color: "black"
self-contained: true
date: today
date-modified: today
date-format: long
format: 
  html:
    theme: zephyr
    toc: true
    toc-depth: 3
    number-sections: true
    number-depth: 3
    smooth-scroll: true
    code-fold: false
execute: 
  message: false
  warning: false
  echo: fenced
bibliography: references.bib
csl: apa.csl
---

# **Background**

Recently. I published a data analysis project titled [] in my Rpubs site. The analysis provoked quite a bit of interest that it motivated me to go a little deeper into analyzing the corporate landscape in Africa. In this mopre comprehensive analysis project, I use data from the [Africa Business](https://african.business/2023/05/long-reads/africas-top-250-companies-in-2023-doing-business-in-tough-times) to explore the 250 largest formal corporations in the continent ^[The data is available on this link <https://african.business/2023/05/long-reads/africas-top-250-companies-in-2023-doing-business-in-tough-times>]. 

# **Objectives**

The primary objectives of the analysis is to explore trends in the corporate environment in Africa. 

Specifically, we examine the following matters. 

1. Which companies have the best financial performance in 2022 and 2023?
2. Which countries have the highest concentration of companies in the top 250 largest corporations in Africa?
3. Which industries have the highest concentration of companies in the top 250 largest corporations in Africa?

# Data
I scrape the data using Libreoffice calc. [Libreoffice calc](https://www.libreoffice.org/discover/calc/) is the equivalent of Ms Excel except that it is free to use. Next, I load the required python packages and read in the data. 

```{python}
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
```

```{python}
africa = pd.read_excel("africa250.xlsx")

africa.head(10)
```

# **Data Exploration**

## **Variables, Observations, and Data Types**

Lets us check the variables and observations present in the data. There are 250 observations of 9 variables. 

```{python}
africa.info()
```

The variables in the data are the following. 

```{python}
africa.columns.values
```

- Ranking2023: The company ranking by market value in 2023.
- Ranking2022: The company ranking by market value in 2022.
- Name: The company name.
- Sector: The company sector of business operations.
- Stock exchange: The stock exchange where company stocks are listed.
- Market_value_22: The company market value in 2022.
- Market_value_23: The company market value in 2023.
- Revenue_latest: Latest reported company annual revenues.
- Net_income_latest: Latest reported company net income. 

We find that has captured the variables ranking2022 and market_value_2022 as text rather than numeric values. To correct this anomaly, we convert these variables to the appropriate data format. 

```{python}
africa["ranking2022"] = pd.to_numeric(africa["ranking2022"], errors = "coerce")
africa["market_value_22"] = pd.to_numeric(africa["market_value_22"], errors = "coerce")

africa.info()
```


## **Missing Values**

We examine the missing values in the variables. For the rankings, all the missing values relate to new entrants in the data. For instance, a company may have entered the list of 250 companies in 2023. Hence, ranking for 2022 is a missing value. Likewise, a company may hae been ranked in 2022 but dropped out of the ranking of 250 companies in 2023.

```{python}
[col for col in africa.columns if africa[col].isnull().any()]
```

We see the columns that have missing values. Our interest is in revenues and net income. 

```{python}
africa.isna().sum()
```

```{python}
africa.isna().sum().sort_values(ascending=False).plot(kind = "barh")
```

